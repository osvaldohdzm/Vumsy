import 'dart:convert';

import 'package:web_app/models/scope.dart';
import 'package:web_app/models/vulnerability.dart';

class VulnerabilityReport {
  final String templateName;
  final String analysisId;
  final String analysisRevision_01;
  final List<Scope> scope;
  final List<String> qaVulnerabilities;
  final List<Vulnerability> vulnerabilities;

  VulnerabilityReport({
    required this.analysisId,
    required this.templateName,
    required this.analysisRevision_01,
    required this.qaVulnerabilities,
    required this.scope,
    required this.vulnerabilities,
  });

  VulnerabilityReport.fromJson(Map<String, dynamic> json)
      : 
        analysisId = json['analysisId'],
        templateName = json['templateName'],
        analysisRevision_01 = json['analysisRevision_01'],
        qaVulnerabilities = json['qaVulnerabilities'],
        vulnerabilities = json['vulnerabilities'],
        scope = json['scope'];

  Map<String, dynamic> toJson() => {
                '<<analysis_id>>': analysisId,
        '<<template_name>>': templateName,
        '<<analysis_revision_01>>"': analysisRevision_01,
        '<<qa_vulnerabilities>>': qaVulnerabilities,
        '<<scope>>"': jsonEncode(scope),
        '<<vulnerabilities>>': jsonEncode(vulnerabilities)
      };
}
